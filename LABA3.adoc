= Отчет по лабораторной работе 3

Задание 1.
Настроить внешний источник частоты HSE и подключить его на системную шину.

Для того, чтобы включить внешний источник частоты HSE необходимо в модуле
RCC выбрать регистр  CR и в поле HSEON включить внешний источник.Затем, для
корректной работы необходимо убедиться в готовности источника. Для этого воспользуемся
функцией while. Нам нужно дождаться пока в поле HSERDY не запишится 1. Это
означает, что источник включен и готов к использованию.
Следующим этапом необходимо переключить системную частоту
на тактирование нужным источником.Для этого с помощью поля SW регистра SFGR
переключим источник. Далее нужно подождать, пока системная частота  переключится на
HSE источник.Для этого аналогичным образом воспользуемся функцией while используя
поле SWS, которое говорит о готовности внешнего источника, и ждем, пока внешний
источник не станет системным.После этого мы можем выключить внутреннюю частоту с
помощью поля HSION.Далее, для проверки создадим большой цикл,с помощью которогого
начинает моргать светодиод.


image::https://github.com/musenzovakhomenko/laba3/blob/main/1_1.jpg[]

image::https://github.com/musenzovakhomenko/laba3/blob/main/1_2.jpg[]

Загрузим код в плату и проверим результат:

include::https://github.com/musenzovakhomenko/laba3/blob/main/1gif.gif[]



В результате видно, что светодиоды моргают с частотой внешнего источника.


Задание 2. Настроить внутренний источник частоты HSI и подключить его на системную шину.

Для включения внутреннего источника питания необходимо из предыдущего кода убрать команды
включения HSE источника. Так как не подключен никакой источник питания, микроконтроллер
работает от внутренней частоты. Для наглядности проверки изменения источника
подключим светодиод, который будет моргать с частотой тактирования.


image::https://github.com/musenzovakhomenko/laba3/blob/main/2_1.jpg[]

Загрузим код в плату и проверим результат:


image::https://github.com/musenzovakhomenko/laba3/blob/main/2gif.gif[]

В результате видно, что светодиод начал моргать в два раза чаще, чем при тактировании
внешним источником.Это связано с тем, что частота внешнего источника составляет 8 МГц,
а внутреннего 16 МГц, что отображается на частоте моргания светодиода.

Задание 3. Настроить PIL источник тактовой частоты на 32 Мгц и подключить его на системную шину.

Для этого первым делом включим внешний источник.Затем дожидаемся его готовности.
Далее необходимо установить нужную частоту. Зная систему тактирования нашего микроконтроллера,
мы можем начать установку частоты с модуля НSI , который имеет известную частоту равную 16 МГц.
Следуя схеме мы попадаем на делитель,в котором должны преобразовать нашу частоту
таким образом чтобы на модуле VCC её значение составило 2 или 1 МГц. Для этого разделим
известную частоту на 8 и в итоге на модуль VCC попадает начение 2 МГц. Далее для получения
заданного значения нужно умножить и разделить значение модуля  VCC на некоторые числа.
Для этого умножаем частоту на 64 получаем на выходе частоту 128 МГц. Данное частота является верной
так как лежит в диапазоне от 100 до 432 МГц.
Затем на делитель р, который может принимать значения 2, 4, 6, 8. Разделим 128 МГц на 4 и в итоге
получим заданную частоту 32 МГц. И  переключаем  системный источник на полученную частоту.
Дожидаемся, пока системная частота переключится на наш источник. Проверим правильность выполнения
кода с помощью поргания светодиодом. Полученный код приведен ниже:


image::https://github.com/musenzovakhomenko/laba3/blob/main/3_1.jpg[]

Image::https://github.com/musenzovakhomenko/laba3/blob/main/3_2.jpg[]

Загрузим код в плату:

image::https://github.com/musenzovakhomenko/laba3/blob/main/3gif.gif[]

В результате видно, что светодиод моргает в 2 раза быстрее чем в предыдущем задании.Значит
требование задания выполняется.


_Ответы на вопросы._

1.Что такое POD типы данных?

Это тип данных, имеющий жёстко определённое расположение полей в памяти, не
требующий ограничения доступа и автоматического управления. Переменные такого
типа можно копировать простыми процедурами копирования участков памяти

2.Назовите все виды типов в языке С++

bool,char,unsigned char,int unsigned int, float double.

3.Что такое пользовательский тип?

Пользовательский тип данных – это тип данных,
определяемый пользователем. Пользовательские типы данных дают возможность строить
свои типы данных на основе уже имеющихся.

4.Назовите модификаторы типов.

short int, unsigned short int, long int, unsigned long int, long double

5.Назовите правило установки размеров типов

Типы переменной и выражения должны совпадать.
Из этого правила есть одно исключение: переменной вещественного типа
можно присваивать значение целочисленного выражения. В таком случае значение
целого числа преобразуется к формату с плавающей запятой
и присвоится вещественной переменной.

6.Что делает оператор sizeof()?

Оператор sizeof — это унарный оператор, который вычисляет и возвращает
размер определенной переменной или определенного типа данных в байтах.

7.Что характеризует тип std::size_t

Предназначен для отображения размера любого объекта в байтах.
Выражает максимальный размер любого объекта.

8.Назовите фиксированные типы целых в библиотеке std

int8_t, uint8_t, int16_t, uint16_t, int32_t, uint32_t, int64_t, uint64_t

9.Что такое псевдоним типа?

Псевдоним типа – средство языка программирования C++,
введённое в синтаксис стандарта для повышения удобства обращения
к пользовательским и встроенным типам данных.

10.Что такое явное и неявное преобразование типа?

Неявное преобразование выполняется всякий раз,
когда требуется один фундаментальный тип данных, но предоставляется другой,
и пользователь не указывает компилятору, как выполнить конвертацию.
Явное преобразование данных выполняет сам пользователь.

11.Какие явные преобразования типов вы знаете?

static_cast, const_cast, reinterpret_cast, dynamic_cast

12.Что делает reinterpret_cast?

reinterpret_cast преобразует типы, несовместимые друг с другом

13.Чем static_cast отличается от reinterpret_cast?

static_cast позволяет сделать приведение близких типов (целые,
пользовательских типов которые могут создаваться из типов который приводится,
и указатель на void* к указателю на любой тип), а static_cast позволяет сделать
приведение близких типов.

14.Что такое ОЗУ и ПЗУ?

Микроконтроллер имеет постоянную память, из которой можно только читать (ПЗУ)
и оперативную память, из которой можно читать и в которую можно писать (ОЗУ).

15.Каков размер памяти ARM Cortex микроконтроллеров?

Ядро ARM имеет 4 Гбайт последовательной памяти.

16.По какой архитектуре разработан ARM Cortex микроконтроллер?

По Гарвардской архитектуре разработан ARM Cortex микроконтроллер.

17.В чем отличие Гарвардской архитектуры от Архитектура ФонНеймана?

Архитектура ФонНеймана имеет только одну шину, которая используется как
для извлечения команд, так и для передачи данных, и операции должны быть
запланированы, потому что они не могут быть выполнены одновременно. Архитектура
Гарварда имеет отдельное пространство памяти для инструкций и данных, которые
физически разделяют сигналы и память для памяти кода и данных, что, в свою очередь,
позволяет одновременно обращаться к каждой из систем памяти.

18.Где располагаются локальные переменные?

Локальные переменные располагаются в регистрах или в стеке.

19.Где располагаются статические переменные?

Статические переменные располагаются в области памяти, которая
была выделена под эту переменную и не будет изменяться, то есть
закрепляется за этой переменной до конца работы приложения.

20.Где располагаются глобальные переменные?

Глобальные переменные распологаются в статически распределенной памяти

21.Что такое стек?

Стек – абстрактный тип данных, представляющий собой список элементов,
организованных по принципу LIFO (англ. last in — first out, «последним пришёл —
первым вышел»).

22.Что такое указатель?

Указатель – это вид переменной, которая хранит адрес в памяти.
Объявляется указатель с помощью звездочки.

23.Что такое разыменовывание указателя?

Операция разыменования указателя представляет выражение в виде *имя_указателя.
Эта операция позволяет получить объект по адресу, который хранится в указателе.

24.Что означает взятие адреса?

Оператор &. Это унарный оператор, возвращающий адрес операнда в памяти.
Например: m = &count; помещает в m адрес переменной count. Это адрес внутреннего
местоположения переменной в компьютере. С самим значением переменной ничего не делается.
Оператор & можно запомнить как «взятие адреса». Поэтому вышеупомянутый оператор
присваивания можно прочитать как «m получает адрес count».

25.Какие операции можно выполнять над указателями?

Указатели поддерживают ряд операций: присваивание, получение адреса указателя,
получение значения по указателю, некоторые арифметические операции и операции сравнения.

26.Что такое константный указатель?

Константный указатель — это указатель, значение которого не может быть изменено
после инициализации.

27.Что такое указатель на константу?

Указатель на константное значение — это неконстантный указатель, который указывает на
неизменное значение.

28.Что такое ссылка? В чем её отличие от указателя?

Ссылка это псевдоним переменной.

Отличия ссылок от указателей:

а. Указатель может быть переназначен любое количество раз, в то время как ссылка
после привязки не может быть перемещена на другую ячейку памяти.

б. Указатели могут указывать "в никуда" (быть равными NULL), в то время как ссылка
всегда указывает на определенный объект

в. Нельзя получить адрес ссылки, как можно это делать с указателями.

г. Не существует арифметики ссылок, в то время как существует арифметика указателей.

29.Что такое регистр?

Регистр — это особый вид памяти внутри микроконтроллера, который используется
для управления процессором и периферийными устройствами. Каждый регистр в архитектуре
ARM представляет собой ячейку памяти и имеет длину в 32 бита, где каждый бит можно
представить в виде крошечного выключателя с помощью которого осуществляется управление
тем или иным параметром микроконтроллера.

30.Что такое регистры общего назначения?

Регистры общего назначения - это сверхбыстрая память внутри процессора,
предназначенная для хранения адресов и промежуточных результатов вычислений
(регистр общего назначения/регистр данных) или данных, необходимых для работы
самого процессора.

31.Что такое регистры специального назначения?

Регистры специального назначения расположены в ОЗУ микроконтроллера и используются
для управления процессором и периферийными устройствами.

32.Как можно установить бит в регистре специального назначения?

Так как регистр специального назначения - это просто адресуемая ячейка памяти,
то в коде это может мы можем обратиться к данным по этому адресу, разыменовывая
указатель, указывающий на этот адрес и записываем 1 в нулевой бит ячейки
памяти (регистра) с помощью логического оператора либо
используя специальные классы С++.

33.Объясните как вызывается функция

Функция вызывается по имени. Если у функции есть параметры, то при вызове после
имени функции в кругых скобках указываются фактические параметры функции
(аргументы функции). Аргументы указываются без типов и разделяются запятыми.
Если у функции нет параметров, то она вызывается с пустыми круглыми скобками после
имени функции.
Синтаксис вызова функции:

Имя функции ([список аргументов])

34.Что такое трансляция?

Трансляция – преобразование кода во внутреннее машинное представление.

35.Что такое компоновка?

Из нескольких объектных файлов создается единый исполняемый файл. На этом этапе
полученный файл является единственным, а потому компоновщик будет жаловаться на
найденные неопределенные функции. На этапе компиляции, если компилятор не мог найти
определение для какой-то функции, считается, что функция была определена в другом файле.
Если это не так, компилятор об этом знать не будет, так как не смотрит на содержание
более чем одного файла за раз. Компоновщик, с другой стороны, может смотреть на
несколько файлов и попытаться найти ссылки на функции, которые не были упомянуты.

36.Как лучше организовывать структуру проекта и почему?

Для удобства структуру проекта лучше всего организовать в виде папок ,
которые будут соответствовать структуре ИМЯ ПЕРИФЕРИ/ИМЯ РЕГИСТРА/ИМЯ ПОЛЯ/Values.
Это позволит как можно быстрее ориентироваться в файлах проекта.

37.Что такое операторы?

Оператор - это символ, который сообщает компилятору выполнить определенные
математические или логические манипуляции.

38.Какие арифметические операторы вы знаете?

Арифметические операторы: присваивание, сложение, вычитание, умножение, деление,
унарный плюс, унарный минус.

39.Какие логические операторы вы знаете?

Логические операторы: логическое отрицание, логическое умножение, логическое сложение.

40.Какие побитовые операторы вы знаете?

Побитовые операторы: побитовая инверсия, побитовое И, побитовое ИЛИ,
побитовое исключающее ИЛИ, побитовый сдвиг влево, побитовый сдвиг вправо.

42.Какие еще операторы вы знаете?

Реляционные операторы, операторы присваивания, sizeof, Cast, &, *.

43.Как сбросить бит с помощью битовых операторов?

Для сброса битов используется оператор &

44.Как установить бит с помощью битовых операторов?

Для установления бита необходимо воспользоваться битовым оператором побитовым ИЛИ.

45.Как поменять значение бита с помощью битовых операторов?

Чтобы поменять значение бита необходимо воспользоваться оператором НЕ.
Он меняет значение на противоположное.

46.Какой микроконтроллер на отладочной плате XNUCLE ST32F411?

Используется микроконтроллер STM32F411 RET6

47.Какие блоки входят в состав микроконтроллера STM32F411?

image::https://github.com/musenzovakhomenko/laba3/blob/main/47_cr.png[]


48.В чем отличие ядра CortexM4 от CortexM3?

Вариант микроконтроллерного ядра Cortex-M4, по сравнению с Cortex-M3,
не характеризуется ростом общих показателей. Фактически M4 тот же самый M3,
но дополнительно оснащенный DSP-инструкциями. Наличие последних существенно ускоряет
обработку потоковых данных, что в свою очередь делает M4 весьма привлекательным для
использования в системах управления и обработки информации. Возможности DSP, входящего
в состав M4, позволяют параллельно выполнять четыре операции сложения/вычитания для 8-ми
разрядных чисел или две операции сложения/вычитания с16-ти разрядными операндами. Также
реализовано умножение за один цикл, при этом для 16-ти разрядных чисел возможно
параллельное исполнение двух операций.

49.Назовите основные характеристики микроконтроллера STM32F411.

32 разрядное ядро ARM Cortex-M4

512 кБайт памяти программ

Встроенный 12 битный 16 канальный АЦП

USB 2.0

5 x SPI/I2S

SDIO интерфейс для карт SD/MMC/eMMC

6 - 16 разрядных и 2 - 32 разрядных Таймера

2 сторожевых таймера

Работа на частотах до 100Мгц

Питание от 1.7 до 3.6 Вольт

Блок работы с числами с плавающей точкой FPU

128 кБайт ОЗУ

DMA контроллер на 16 каналов

3x USART

Аппаратный подсчет контрольной суммы памяти программ CRC

1 системный таймер

1 - 16 битный для управления двигателями

81 портов ввода вывода

Потребление 100 мкА/Мгц

50.Назовите дополнительные характеристики микроконтроллера STM32F411.

Дополнительные характеристики:

· Настраиваемые источники тактовой частоты

· Настраиваемые на различные функции порты

· Внутренний температурный сенсор

· Таймеры с настраиваемым модулем ШИМ

· DMA для работы с модулями (SPI, UART, ADC… )

· 12 разрядный ADC последовательного приближения

· Часы реального времени

· Системный таймер и спец. прерывания для облегчения и ускорения работы ОСРВ

51.Какие источники тактирования есть у микроконтроллера STM32F411

Для формирования системной тактовой частоты SYSCLK могут использоваться
4 основных источника:

1. HSI (high-speed internal) — внутренний высокочастотный RC-генератор.

2. HSE (high-speed external) — внешний высокочастотный генератор.

3. PLL — система ФАПЧ. Точнее сказать, это вовсе и не генератор, а набор из умножителей и делителей, исходный сигнал он получает от HSI или HSE, а на выходе у него уже другая частота.

Также имеются 2 вторичных источника тактового сигнала:

1. LSI (low-speed internal) — низкочастотный внутренний RC-генератор на 37 кГц

2. LSE (low-speed external) — низкочастотный внешний источник на 32,768 кГц

52.Назовите алгоритм подключения системной частоты к источнику тактирования
микроконтроллера STM32F411.

1. Определить какие источники частоты нужны
(Например, PLL нужен для USB)

2. Включить нужный источник
(Используя Clock Control register (RCC::CR))

3. Дождаться стабилизации источника
(Используя соответствующие биты (..RDY) Clock Control register (RCC::CR))

4. Назначить нужный источник на системную частоту
(Используя Clock Configuration Register (RCC::CFGR))

5. Дождаться пока источник не переключиться на системную частоту
(Используя Clock Configuration Register (RCC::CFGR))

53.Что такое ФАПЧ?

Фа́зовая автоподстро́йка частоты – система автоматического регулирования, подстраивающая
фазу управляемого генератора так, чтобы она была равна фазе опорного сигнала, либо
отличалась на известную функцию от времени.







